<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="no-referrer">
    <title>JOE OS | 播放中心</title>
    <link href="https://vjs.zencdn.net/8.10.0/video-js.css" rel="stylesheet" />
    <style>
        :root {
            --primary: #00fb9a;
            --bg: #f8fafc;
            --panel: #ffffff;
            --text: #1e293b;
        }

        body, html { margin: 0; padding: 0; background: var(--bg); color: var(--text); font-family: "PingFang SC", sans-serif; }

        /* --- 导航栏 --- */
        header {
            background: rgba(255,255,255,0.8); backdrop-filter: blur(10px);
            height: 60px; display: flex; align-items: center; padding: 0 40px;
            position: sticky; top: 0; z-index: 100; border-bottom: 1px solid #e2e8f0;
        }
        .logo { font-size: 22px; font-weight: 900; color: #a29bfe; margin-right: 30px; }

        /* --- 详情页主容器 --- */
        .player-page { max-width: 1400px; margin: 30px auto; padding: 0 20px; display: grid; grid-template-columns: 1fr 350px; gap: 25px; }

        /* 左侧：播放器与介绍 */
        .main-col { display: flex; flex-direction: column; gap: 20px; }
        .video-wrapper { background: #000; border-radius: 12px; overflow: hidden; aspect-ratio: 16/9; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
        
        .video-info { background: var(--panel); padding: 25px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        .v-title { font-size: 24px; font-weight: bold; margin-bottom: 10px; display: flex; align-items: center; gap: 10px; }
        .v-tags { display: flex; gap: 8px; margin-bottom: 15px; }
        .tag { font-size: 12px; padding: 4px 10px; background: #f1f5f9; border-radius: 4px; color: #64748b; }
        .v-desc { font-size: 14px; color: #64748b; line-height: 1.8; }

        /* 右侧：选集与换源 (复刻截图逻辑) */
        .side-col { background: var(--panel); border-radius: 12px; display: flex; flex-direction: column; overflow: hidden; box-shadow: 0 4px 6px rgba(0,0,0,0.05); height: fit-content; max-height: 800px; }
        
        /* 侧边栏页签切换 */
        .tabs { display: flex; border-bottom: 1px solid #f1f5f9; }
        .tab-item { flex: 1; text-align: center; padding: 15px; cursor: pointer; font-size: 14px; font-weight: bold; color: #94a3b8; transition: 0.3s; }
        .tab-item.active { color: var(--text); border-bottom: 2px solid #a29bfe; background: #f8fafc; }

        .tab-content { padding: 15px; overflow-y: auto; flex: 1; }

        /* 选集格子 */
        .ep-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; }
        .ep-item { background: #f1f5f9; padding: 10px 0; text-align: center; border-radius: 6px; font-size: 12px; cursor: pointer; transition: 0.2s; border: 1px solid transparent; }
        .ep-item:hover { background: #e2e8f0; }
        .ep-item.active { background: #a29bfe; color: white; border-color: #a29bfe; }

        /* 换源列表 (复刻截图右侧) */
        .source-item { 
            display: flex; align-items: center; gap: 12px; padding: 12px; border-radius: 8px; 
            margin-bottom: 10px; background: #f8fafc; cursor: pointer; border: 1px solid transparent;
        }
        .source-item:hover { background: #f1f5f9; }
        .source-item.active { border-color: #a29bfe; background: #f3f0ff; }
        .source-icon { width: 40px; height: 40px; border-radius: 6px; background: #ddd; object-fit: cover; }
        .source-info { flex: 1; }
        .source-name { font-size: 13px; font-weight: bold; }
        .source-status { font-size: 11px; color: #a29bfe; margin-top: 3px; }
        .status-fail { color: #ff6b6b; }
    </style>
</head>
<body>

<header>
    <div class="logo">JOE OS</div>
    <div style="font-size: 14px; color: #64748b;">详情播放页</div>
</header>

<div class="player-page">
    <div class="main-col">
        <div class="video-wrapper">
            <video id="v-core" class="video-js vjs-big-play-centered vjs-16-9" controls preload="auto" width="100%"></video>
        </div>
        
        <div class="video-info">
            <div class="v-title" id="v-title">加载中... <span style="font-size:14px; color:#a29bfe; font-weight:normal;">❤️ 收藏</span></div>
            <div class="v-tags" id="v-tags">
                <span class="tag">2024</span>
                <span class="tag">4K超清</span>
                <span class="tag">国产动漫</span>
            </div>
            <div class="v-desc" id="v-desc">正在拉取影片简介...</div>
        </div>
    </div>

    <div class="side-col">
        <div class="tabs">
            <div class="tab-item active" onclick="switchTab('ep')">选集</div>
            <div class="tab-item" onclick="switchTab('source')">换源</div>
        </div>
        
        <div id="ep-panel" class="tab-content">
            <div class="ep-grid" id="ep-list">
                </div>
        </div>

        <div id="source-panel" class="tab-content" style="display:none;">
            <div id="source-list">
                </div>
        </div>
    </div>
</div>

<script src="https://vjs.zencdn.net/8.10.0/video.min.js"></script>
<script>
    const player = videojs('v-core');
    let currentData = null; // 存储当前影片所有源数据

    // 1. 模拟数据加载 (正式版应由首页跳转并带参数)
    window.onload = () => {
        const mockVideo = {
            vod_name: "仙逆",
            vod_content: "乡村平凡少年王林，为了心中不屈的信念踏入仙门修行，克服天赋不足的困境，逆流而上，积极面对苦难与挑战，不断突破自我，最终将命运始终牢牢地把握在自己手中！",
            vod_tag: "剧情,动画,古装",
            sources: [
                { name: "量子4K", status: "推荐", icon: "https://api.dicebear.com/7.x/identicon/svg?seed=lz", urls: "01$url1#02$url2#03$url3" },
                { name: "非凡影视", status: "检测失败", icon: "https://api.dicebear.com/7.x/identicon/svg?seed=ff", urls: "01$url4#02$url5" },
                { name: "暴风高清", status: "在线", icon: "https://api.dicebear.com/7.x/identicon/svg?seed=bf", urls: "01$url6#02$url7" }
            ]
        };
        initPage(mockVideo);
    };

    function initPage(data) {
        currentData = data;
        document.getElementById('v-title').innerHTML = `${data.vod_name} <span style="font-size:14px; color:#a29bfe; font-weight:normal;">❤️ 收藏</span>`;
        document.getElementById('v-desc').innerText = data.vod_content;
        
        // 渲染标签
        const tagBox = document.getElementById('v-tags');
        tagBox.innerHTML = data.vod_tag.split(',').map(t => `<span class="tag">${t}</span>`).join('');

        renderSources();
        switchSource(0); // 默认选择第一个源
    }

    // 2. 渲染换源列表
    function renderSources() {
        const box = document.getElementById('source-list');
        box.innerHTML = currentData.sources.map((s, idx) => `
            <div class="source-item ${idx===0?'active':''}" onclick="switchSource(${idx})">
                <img src="${s.icon}" class="source-icon">
                <div class="source-info">
                    <div class="source-name">${s.name}</div>
                    <div class="source-status ${s.status==='检测失败'?'status-fail':''}">${s.status}</div>
                </div>
            </div>
        `).join('');
    }

    // 3. 切换播放源
    function switchSource(idx) {
        const source = currentData.sources[idx];
        const items = document.querySelectorAll('.source-item');
        items.forEach(el => el.classList.remove('active'));
        items[idx].classList.add('active');

        // 渲染该源下的选集
        const epBox = document.getElementById('ep-list');
        const eps = source.urls.split('#');
        epBox.innerHTML = eps.map((ep, eIdx) => {
            const [name, url] = ep.split('$');
            return `<div class="ep-item" onclick="playEp('${url}', this)">${name}</div>`;
        }).join('');

        // 默认播放第一集
        if(epBox.firstChild) epBox.firstChild.click();
    }

    function playEp(url, el) {
        document.querySelectorAll('.ep-item').forEach(i => i.classList.remove('active'));
        el.classList.add('active');
        
        // 这里替换为真实的 M3U8 地址
        player.src({ src: 'https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8', type: 'application/x-mpegURL' });
        player.play();
    }

    // 4. 页签切换逻辑
    function switchTab(type) {
        const tabs = document.querySelectorAll('.tab-item');
        tabs.forEach(t => t.classList.remove('active'));
        
        if(type === 'ep') {
            tabs[0].classList.add('active');
            document.getElementById('ep-panel').style.display = 'block';
            document.getElementById('source-panel').style.display = 'none';
        } else {
            tabs[1].classList.add('active');
            document.getElementById('ep-panel').style.display = 'none';
            document.getElementById('source-panel').style.display = 'block';
        }
    }
</script>
</body>
</html>
